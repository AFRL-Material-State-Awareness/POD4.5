<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculate reference distribution using parametric bootstrap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for PBrefdist {pbkrtest}"><tr><td>PBrefdist {pbkrtest}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Calculate reference distribution using parametric bootstrap
</h2>

<h3>Description</h3>

<p>Calculate reference distribution of likelihood ratio statistic in
mixed effects models using parametric bootstrap 
</p>


<h3>Usage</h3>

<pre>
PBrefdist(largeModel, smallModel, nsim = 1000, seed=NULL, cl = NULL, details = 0)



</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>largeModel</code></td>
<td>

<p>A linear mixed effects model as fitted with the <code>lmer()</code>
function in the <span class="pkg">lme4</span> package. This model muse be larger than
<code>smallModel</code> (see below). 
</p>
</td></tr>
<tr valign="top"><td><code>smallModel</code></td>
<td>

<p>A linear mixed effects model as fitted with the <code>lmer()</code>
function in the <span class="pkg">lme4</span> package. This model muse be smaller than
<code>largeModel</code> (see above). 
</p>
</td></tr>
<tr valign="top"><td><code>nsim</code></td>
<td>

<p>The number of simulations to form the reference distribution.
</p>
</td></tr>
<tr valign="top"><td><code>seed</code></td>
<td>

<p>Seed for the random number generation.
</p>
</td></tr>
<tr valign="top"><td><code>cl</code></td>
<td>

<p>A vector identifying a cluster; used for
calculating the reference distribution using several cores. See
examples below.
</p>
</td></tr>
<tr valign="top"><td><code>details</code></td>
<td>

<p>The amount of output produced. Mainly relevant for debugging
purposes.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model <code>object</code> must be fitted with maximum likelihood (i.e. with
<code>REML=FALSE</code>). If the object is fitted with restricted maximum
likelihood (i.e. with
<code>REML=TRUE</code>) then the model is refitted with <code>REML=FALSE</code>
before the p-values are calculated. Put differently, the user needs
not worry about this issue.
</p>


<h3>Value</h3>

<p>A numeric vector
</p>


<h3>Author(s)</h3>

<p>Soren Hojsgaard <a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>References</h3>

<p>Ulrich Halekoh, Søren Højsgaard (2014).,
A Kenward-Roger Approximation and Parametric Bootstrap Methods for Tests in Linear Mixed Models - The R Package pbkrtest.,
Journal of Statistical Software, 58(10), 1-30., <a href="http://www.jstatsoft.org/v59/i09/">http://www.jstatsoft.org/v59/i09/</a>
</p>


<h3>See Also</h3>

<p><code><a href="PBmodcomp.html">PBmodcomp</a></code>,



<code><a href="KRmodcomp.html">KRmodcomp</a></code>
</p>


<h3>Examples</h3>

<pre>
data(beets)
head(beets)
beet0&lt;-lmer(sugpct~block+sow+harvest+(1|block:harvest), data=beets, REML=FALSE)
beet_no.harv &lt;- update(beet0, .~.-harvest)
rr &lt;- PBrefdist(beet0, beet_no.harv, nsim=20)
rr

## Note clearly many more than 10 simulations must be made in practice.

## Computations can be made in parallel using several processors:
## Not run: 
cl &lt;- makeSOCKcluster(rep("localhost", 4))
clusterEvalQ(cl, library(lme4))
clusterSetupSPRNG(cl)
rr &lt;- PBrefdist(beet0, beet_no.harv, nsim=20)
stopCluster(cl)

## End(Not run)
## Above, 4 cpu's are used and 5 simulations are made on each cpu.
</pre>

<hr /><div style="text-align: center;">[Package <em>pbkrtest</em> version 0.4-5 <a href="00Index.html">Index</a>]</div>
</body></html>
