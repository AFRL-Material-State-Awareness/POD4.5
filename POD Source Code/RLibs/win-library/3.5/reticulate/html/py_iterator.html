<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Create a Python iterator from an R function</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for py_iterator {reticulate}"><tr><td>py_iterator {reticulate}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Create a Python iterator from an R function</h2>

<h3>Description</h3>

<p>Create a Python iterator from an R function
</p>


<h3>Usage</h3>

<pre>
py_iterator(fn, completed = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>fn</code></td>
<td>
<p>R function with no arguments.</p>
</td></tr>
<tr valign="top"><td><code>completed</code></td>
<td>
<p>Special sentinel return value which indicates that
iteration is complete (defaults to <code>NULL</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Python generators are functions that implement the Python iterator
protocol. In Python, values are returned using the <code>yield</code> keyword. In R,
values are simply returned from the function.
</p>
<p>In Python, the <code>yield</code> keyword enables successive iterations to use the state
of previous iterations. In R, this can be done by returning a function that
mutates its enclosing environment via the <code style="white-space: pre;">&lt;&lt;-</code> operator. For example:<div class="sourceCode r"></p>
<pre>sequence_generator &lt;- function(start) {
  value &lt;- start
  function() {
    value &lt;&lt;- value + 1
    value
  }
}
</pre></div>
<p>Then create an iterator using <code>py_iterator()</code>:<div class="sourceCode r"></p>
<pre>g &lt;- py_iterator(sequence_generator(10))
</pre></div>


<h3>Value</h3>

<p>Python iterator which calls the R function for each iteration.
</p>


<h3>Ending Iteration</h3>

<p>In Python, returning from a function without calling <code>yield</code> indicates the
end of the iteration. In R however, <code>return</code> is used to yield values, so
the end of iteration is indicated by a special return value (<code>NULL</code> by
default, however this can be changed using the <code>completed</code> parameter). For
example:<div class="sourceCode r"></p>
<pre>sequence_generator &lt;-function(start) {
  value &lt;- start
  function() {
    value &lt;&lt;- value + 1
    if (value &lt; 100)
      value
    else
      NULL
  }
}
</pre></div>


<h3>Threading</h3>

<p>Some Python APIs use generators to parallellize operations by calling the
generator on a background thread and then consuming its results on
the foreground thread. The <code>py_iterator()</code> function creates threadsafe
iterators by ensuring that the R function is always called on the main
thread (to be compatible with R's single-threaded runtime) even if the
generator is run on a background thread.
</p>

<hr /><div style="text-align: center;">[Package <em>reticulate</em> version 1.25 <a href="00Index.html">Index</a>]</div>
</body></html>
