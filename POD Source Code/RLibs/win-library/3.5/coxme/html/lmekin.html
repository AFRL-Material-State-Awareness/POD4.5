<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fit a linear mixed effects model</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for lmekin {coxme}"><tr><td>lmekin {coxme}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fit a linear mixed effects model</h2>

<h3>Description</h3>

<p>The lmekin function fits a linear mixed effects model, with random
effects specified in the same structure as in the <code>coxme</code>
function.
</p>


<h3>Usage</h3>

<pre>
lmekin(formula, data, weights, subset, na.action, control,
varlist, vfixed, vinit, method = c("ML", "REML"),
x = FALSE, y = FALSE, model=FALSE,
random, fixed, variance, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>

<p>a two-sided formula with the response as the left hand side of a
<code>~</code> operator and the fixed and random effects on the right.
</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>

<p>an optional data frame containing the variables named in the <code>formula</code>.
</p>
</td></tr>
<tr valign="top"><td><code>subset, weights, na.action</code></td>
<td>

<p>further model specifications arguments as in <code>lm</code>; see there
for details.
</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>

<p>optional list of control options.  See <code>coxme.control</code> for details. 
</p>
</td></tr>
<tr valign="top"><td><code>varlist</code></td>
<td>

<p>the variance family to be used for each random term.  If there are
multiple terms it will be a list of variance functions.
The default is <code>coxmeFull</code>.
Alternatively it can be a list of matrices, in which case the
<code>coxmeMlist</code> function is used.
</p>
</td></tr>
<tr valign="top"><td><code>vfixed</code></td>
<td>

<p>optional named list or vector used to fix the value of one or more
of the variance terms at a constant.
</p>
</td></tr>
<tr valign="top"><td><code>vinit</code></td>
<td>

<p>optional named list or vector giving suggested starting values for
the variance.
</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>fit using either maximum likelihood or restricted
maximum likelihood
</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>

<p>if TRUE the X matrix (fixed effects) is included in the output object
</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>

<p>if TRUE the y variable is included in the output object
</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>

<p>if TRUE the model frame is included in the output object
</p>
</td></tr>
<tr valign="top"><td><code>fixed, random, variance</code></td>
<td>

<p>In an earlier version of <code>lmekin</code>
the fixed and random effects were separate arguments.  These arguments
are included for backwards compatability, but are depreciated.
The variance argument is a depreciated alias for vfixed.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>any other arguments are passed forward to <code>coxme.control</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <i>A = sB</i> be the variance matrix of the random
effects where <i>s</i> is the residual variance for the
model.  Internally the routine solves for the parameters of
<i>B</i>, computing <i>A</i> at the end.  The <code>vinit</code> and
<code>vfixed</code> parmaters refer to <i>B</i>, however.
</p>
<p>It is possible to specify certain models in <code>lmekin</code>
that can not be fit with lme, in particular models with
familial genetic effects, i.e., a <em>kinship</em> matrix, and hence the
name of the routine.  Using user-specified variance functions an even
wider range of models is possible.
For simple models the specification of the random effects follows the
same form as the <code>lmer</code> function.  For any model which can be fit
by both <code>lmekin</code> and <code>lmer</code>, the latter routine would
normally be prefered due to a much wider selection of post-fit tools
for residuals, prediction and plotting.
</p>
<p>Much of the underlying model code for specification and manipulation
of the random effects is shared with the <code>coxme</code> routine.  In
fact lmekin was originally written only to provide a test routine for
those codes, and no expectation that it would find wider utility.
</p>


<h3>Value</h3>

<p>An object of class <code>lmekin</code>.
</p>


<h3>Author(s)</h3>

<p>Terry Therneau</p>


<h3>See Also</h3>

<p><code><a href="lmekin.object.html">lmekin.object</a></code>, <code><a href="coxme.html">coxme</a></code></p>


<h3>Examples</h3>

<pre>
  data(ergoStool, package="nlme")  # use a data set from nlme 
  fit1 &lt;- lmekin(effort ~ Type + (1|Subject), data=ergoStool)
  ## Not run: 
  # gives the same result
  require(nlme)
  fit2 &lt;- lme(effort ~ Type, data=ergoStool, random= ~1|Subject,
            method="ML")
  
## End(Not run) 
</pre>

<hr /><div style="text-align: center;">[Package <em>coxme</em> version 2.2-17 <a href="00Index.html">Index</a>]</div>
</body></html>
