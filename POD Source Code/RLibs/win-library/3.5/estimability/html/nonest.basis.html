<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Estimability Tools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for nonest.basis {estimability}"><tr><td>nonest.basis {estimability}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Estimability Tools</h2>

<h3>Description</h3>

<p>This documents the functions needed to test estimability of linear functions of regression coefficients.
</p>


<h3>Usage</h3>

<pre>
nonest.basis(x, ...)
## Default S3 method:
nonest.basis(x, ...)
## S3 method for class 'qr'
nonest.basis(x, ...)
## S3 method for class 'matrix'
nonest.basis(x, ...)
## S3 method for class 'lm'
nonest.basis(x, ...)
## S3 method for class 'svd'
nonest.basis(x, tol = 5e-8, ...)

all.estble

is.estble(x, nbasis, tol = 1e-8)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>For <code>nonest.basis</code>, an object of a class in <span class="samp">methods("nonest.basis")</span>. Or, in <code>is.estble</code>, a numeric vector or matrix for assessing estimability of <span class="samp">sum(x * beta)</span>, where <code>beta</code> is the vector of regression coefficients.</p>
</td></tr>
<tr valign="top"><td><code>nbasis</code></td>
<td>
<p>Matrix whose columns span the null space of the model matrix. Such a matrix is returned by <code>nonest.basis</code>.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>Numeric tolerance for assessing rank or nonestimability. 
For determining rank, singular values less than <code>tol</code> times the largest singular value are regarded as zero.
For determining estimability with a nonzero <i>x</i>, <i>&beta;'x</i> is assessed by whether or not <i>||N'x||^2 &lt; &tau; ||x'x||^2</i>, where <i>N</i> and <i>&tau;</i> denote <code>nbasis</code> and <code>tol</code>, respectively.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Additional arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a linear model <i>y = X&beta; + E</i>. If <i>X</i> is not of full rank, it is not possible to estimate <i>&beta;</i> uniquely. However, <i>X&beta;</i> <em>is</em> uniquely estimable, and so is <i>a'X&beta;</i> for any conformable vector <i>a</i>. Since <i>a'X</i> comprises a linear combination of the rows of <i>X</i>, it follows that we can estimate any linear function where the coefficients lie in the row space of <i>X</i>. Equivalently, we can check to ensure that the coefficients are orthogonal to the null space of <i>X</i>.
</p>
<p>The <code>nonest.basis</code> method for class <code>'svd'</code> is not really functional as a method because there is no <code>"svd"</code> class (at least in R &lt;= 4.2.0). But the function <code>nonest.basis.svd</code> is exported and may be called directly; it works with results of <code><a href="../../base/html/svd.html">svd</a></code> or <code><a href="../../base/html/svd.html">La.svd</a></code>. We <em>require</em> <code>x$v</code> to be the complete matrix of right singular values; but we do not need <code>x$u</code> at all.
</p>
<p>The <code>default</code> method does serve as an <code>svd</code> method, in that it only works if <code>x</code> has the required elements of an SVD result, in which case it passes it to <code>nonest.basis.svd</code>.
The <code>matrix</code> method runs <code>nonest.basis.svd(svd(x, nu = 0))</code>. The <code>lm</code> method runs the <code>qr</code> method on <code>x$qr</code>.
</p>
<p>The constant <code>all.estble</code> is simply a 1 x 1 matrix of <code>NA</code>. This specifies a trivial non-estimability basis, and using it as <code>nbasis</code> will cause everything to test as estimable. 
</p>


<h3>Value</h3>

<p>When <i>X</i> is not full-rank, the methods for <code>nonest.basis</code> return a basis for the null space of <i>X</i>. The number of rows is equal to the number of regression coefficients (<em>including</em> any <code>NA</code>s); and the number of columns is equal to the rank deficiency of the model matrix. The columns are orthonormal. If the model is full-rank, then <code>nonest.basis</code> returns <code>all.estble</code>. The <code>matrix</code> method uses <i>X</i> itself, the <code>qr</code> method uses the <i>QR</i> decomposition of <i>X</i>, and the <code>lm</code> method recovers the required information from the object.
</p>
<p>The function <code>is.estble</code> returns a logical value (or vector, if <code>x</code> is a matrix) that is <code>TRUE</code> if the function is estimable and <code>FALSE</code> if not. 
</p>


<h3>Author(s)</h3>

<p>Russell V. Lenth &lt;russell-lenth@uiowa.edu&gt;
</p>


<h3>References</h3>

<p>Monahan, John F. (2008) <em>A Primer on Linear Models</em>, CRC Press. (Chapter 3)
</p>


<h3>Examples</h3>

<pre>
require(estimability)

X &lt;- cbind(rep(1,5), 1:5, 5:1, 2:6)
( nb &lt;- nonest.basis(X) )

SVD &lt;- svd(X, nu = 0)    # we don't need the U part of UDV'
nonest.basis.svd(SVD)    # same result as above

# Test estimability of some linear functions for this X matrix
lfs &lt;- rbind(c(1,4,2,5), c(2,3,9,5), c(1,2,2,1), c(0,1,-1,1))
is.estble(lfs, nb)

# Illustration on 'lm' objects:
warp.lm1 &lt;- lm(breaks ~ wool * tension, data = warpbreaks, 
    subset = -(26:38), 
    contrasts = list(wool = "contr.treatment", tension = "contr.treatment"))
zapsmall(warp.nb1 &lt;- nonest.basis(warp.lm1))

warp.lm2 &lt;- update(warp.lm1, 
    contrasts = list(wool = "contr.sum", tension = "contr.helmert"))
zapsmall(warp.nb2 &lt;- nonest.basis(warp.lm2))

# These bases look different, but they both correctly identify the empty cell
wcells = with(warpbreaks, expand.grid(wool = levels(wool), tension = levels(tension)))
epredict(warp.lm1, newdata = wcells, nbasis = warp.nb1)
epredict(warp.lm2, newdata = wcells, nbasis = warp.nb2)
</pre>

<hr /><div style="text-align: center;">[Package <em>estimability</em> version 1.4 <a href="00Index.html">Index</a>]</div>
</body></html>
