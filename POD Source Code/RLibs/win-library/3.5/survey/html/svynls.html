<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Probability-weighted nonlinear least squares</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for svynls {survey}"><tr><td>svynls {survey}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Probability-weighted nonlinear least squares
</h2>

<h3>Description</h3>

<p>Fits a nonlinear model by probability-weighted least squares.  Uses
<code>nls</code> to do the fitting, but estimates design-based standard errors with either
linearisation or replicate weights. See <code><a href="../../stats/html/nls.html">nls</a></code> for 
documentation of model specification and fitting.
</p>


<h3>Usage</h3>

<pre>
svynls(formula, design, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>

<p>Nonlinear model specified as a formula; see <code><a href="../../stats/html/nls.html">nls</a></code>
</p>
</td></tr>
<tr valign="top"><td><code>design</code></td>
<td>

<p>Survey design object
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>

<p>Other arguments to <code>nls</code> (especially, <code>start</code>). Also
supports <code>return.replicates</code> for replicate-weight designs and
<code>influence</code> for other designs. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>svynls</code>. The fitted <code>nls</code> object is
included as the <code>fit</code> element.
</p>


<h3>See Also</h3>

<p><code><a href="svymle.html">svymle</a></code> for maximum likelihood with linear predictors on
one or more parameters
</p>


<h3>Examples</h3>

<pre>
set.seed(2020-4-3)
x&lt;-rep(seq(0,50,1),10)
y&lt;-((runif(1,10,20)*x)/(runif(1,0,10)+x))+rnorm(510,0,1)

pop_model&lt;-nls(y~a*x/(b+x), start=c(a=15,b=5))

df&lt;-data.frame(x=x,y=y)
df$p&lt;-ifelse((y-fitted(pop_model))*(x-mean(x))&gt;0, .4,.1)

df$strata&lt;-ifelse(df$p==.4,"a","b")

in_sample&lt;-stratsample(df$strata, round(table(df$strat)*c(0.4,0.1)))

sdf&lt;-df[in_sample,]
des&lt;-svydesign(id=~1, strata=~strata, prob=~p, data=sdf)
pop_model
(biased_sample&lt;-nls(y~a*x/(b+x),data=sdf, start=c(a=15,b=5)))
(corrected &lt;- svynls(y~a*x/(b+x), design=des, start=c(a=15,b=5)))
</pre>

<hr /><div style="text-align: center;">[Package <em>survey</em> version 4.1-1 <a href="00Index.html">Index</a>]</div>
</body></html>
