<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Safe (generalized) Huber M-Estimator of Location</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for huberM {robustbase}"><tr><td>huberM {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Safe (generalized) Huber M-Estimator of Location</h2>

<h3>Description</h3>

<p>(Generalized) Huber M-estimator of location with MAD scale, being
sensible also when the scale is zero where <code><a href="../../MASS/html/huber.html">huber</a>()</code>
returns an error.
</p>


<h3>Usage</h3>

<pre>
huberM(x, k = 1.5, weights = NULL, tol = 1e-06,
       mu = if(is.null(weights)) median(x) else wgt.himedian(x, weights),
       s =  if(is.null(weights)) mad(x, center=mu)
	    else wgt.himedian(abs(x - mu), weights),
       se = FALSE,
       warn0scale = getOption("verbose"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>positive factor; the algorithm winsorizes at <code>k</code>
standard deviations.</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>numeric vector of non-negative weights of same length
as <code>x</code>, or <code>NULL</code>.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>convergence tolerance.</p>
</td></tr>
<tr valign="top"><td><code>mu</code></td>
<td>
<p>initial location estimator.</p>
</td></tr>
<tr valign="top"><td><code>s</code></td>
<td>
<p>scale estimator held constant through the iterations.</p>
</td></tr>
<tr valign="top"><td><code>se</code></td>
<td>
<p>logical indicating if the standard error should be computed
and returned (as <code>SE</code> component).  Currently only available
when <code>weights</code> is <code>NULL</code>.</p>
</td></tr>
<tr valign="top"><td><code>warn0scale</code></td>
<td>
<p>logical; if true, and <code>s</code> is 0 and
<code>length(x) &gt; 1</code>, this will be warned about.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that currently, when non-<code>NULL</code> <code>weights</code> are
specified, the default for initial location <code>mu</code> and scale
<code>s</code> is <code><a href="wgt.himedian.html">wgt.himedian</a></code>, where strictly speaking a
weighted &ldquo;non-hi&rdquo; median should be used for consistency.
Since <code>s</code> is not updated, the results slightly differ, see the
examples below.
</p>
<p>When <code>se = TRUE</code>, the standard error is computed using the
<i>&tau;</i> correction factor but no finite sample correction.

</p>


<h3>Value</h3>

<p>list of location and scale parameters, and number of iterations used.
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>mu</code></td>
<td>
<p>location estimate</p>
</td></tr>
<tr valign="top"><td><code>s</code></td>
<td>
<p>the <code>s</code> argument, typically the <code><a href="../../stats/html/mad.html">mad</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>it</code></td>
<td>
<p>the number of &ldquo;Huber iterations&rdquo; used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, building on the MASS code mentioned.</p>


<h3>References</h3>

<p>Huber, P. J. (1981)
<em>Robust Statistics.</em>
Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="../../MASS/html/hubers.html">hubers</a></code> (and <code>huber</code>) in package <a href="https://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a>;
<code><a href="../../stats/html/mad.html">mad</a></code>.
</p>


<h3>Examples</h3>

<pre>
huberM(c(1:9, 1000))
mad   (c(1:9, 1000))
mad   (rep(9, 100))
huberM(rep(9, 100))

## When you have "binned" aka replicated observations:
set.seed(7)
x &lt;- c(round(rnorm(1000),1), round(rnorm(50, m=10, sd = 10)))
t.x &lt;- table(x) # -&gt; unique values and multiplicities
x.uniq &lt;- as.numeric(names(t.x)) ## == sort(unique(x))
x.mult &lt;- unname(t.x)
str(Hx  &lt;- huberM(x.uniq, weights = x.mult), digits = 7)
str(Hx. &lt;- huberM(x, s = Hx$s, se=TRUE), digits = 7) ## should be ~= Hx
stopifnot(all.equal(Hx[-4], Hx.[-4]))
str(Hx2 &lt;- huberM(x, se=TRUE), digits = 7)## somewhat different, since 's' differs

## Confirm correctness of std.error :

system.time(
SS &lt;- replicate(10000, vapply(huberM(rnorm(400), se=TRUE), as.double, 1.))
) # ~ 12.2 seconds
rbind(mean(SS["SE",]), sd(SS["mu",]))# both ~ 0.0508
stopifnot(all.equal(mean(SS["SE",]),
                    sd ( SS["mu",]), tolerance= 0.002))

</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.95-0 <a href="00Index.html">Index</a>]</div>
</body></html>
