<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Multi-exponential Fitting</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mexpfit {pracma}"><tr><td>mexpfit {pracma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Multi-exponential Fitting
</h2>

<h3>Description</h3>

<p>Multi-exponential fitting means fitting of data points by a sum of
(decaying) exponential functions, with or without a constant term.
</p>


<h3>Usage</h3>

<pre>
mexpfit(x, y, p0, w = NULL, const = TRUE, options = list())
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x, y</code></td>
<td>
<p>x-, y-coordinates of data points to be fitted.</p>
</td></tr>
<tr valign="top"><td><code>p0</code></td>
<td>
<p>starting values for the exponentials alone; can be positive
or negative, but not zero.</p>
</td></tr>
<tr valign="top"><td><code>w</code></td>
<td>
<p>weight vector; not used in this version.</p>
</td></tr>
<tr valign="top"><td><code>const</code></td>
<td>
<p>logical; shall an absolute term be included.</p>
</td></tr>
<tr valign="top"><td><code>options</code></td>
<td>
<p>list of options for <code>lsqnonlin</code>, see there.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multi-exponential fitting problem is solved here with with a separable
nonlinear least-squares approach. If the following function is to be fitted,
</p>
<p style="text-align: center;"><i>y = a_0 + a_1 e^{b_1 x} + &hellip; + a_n e^{b_n x}</i></p>

<p>it will be looked at as a nonlinear optimization problem of the coefficients
<i>b_i</i> alone. Given the <i>b_i</i>, coefficients <i>a_i</i> are uniquely
determined as solution of an (overdetermined) system of linear equations.
</p>
<p>This approach reduces the dimension of the search space by half and improves
numerical stability and accuracy. As a convex problem, the solution is unique
and global.
</p>
<p>To solve the nonlinear part, the function <code>lsqnonlin</code> that uses the
Levenberg-Marquard algorithm will be applied.
</p>


<h3>Value</h3>

<p><code>mexpfit</code> returns a list with the following elements:
</p>

<ul>
<li> <p><code>a0</code>: the absolute term, 0 if <code>const</code> is false.
</p>
</li>
<li> <p><code>a</code>: linear coefficients.
</p>
</li>
<li> <p><code>b</code>: coefficient in the exponential functions.
</p>
</li>
<li> <p><code>ssq</code>: the sum of squares for the final fitting.
</p>
</li>
<li> <p><code>iter</code>: number of iterations resp. function calls.
</p>
</li>
<li> <p><code>errmess</code>: an error or info message.
</p>
</li></ul>



<h3>Note</h3>

<p>As the Jacobian for this expression is known, a more specialized approch
would be possible, without using <code>lsqnonlin</code>;
see the <code>immoptibox</code> of H. B. Nielsen, Techn. University of Denmark.
</p>


<h3>Author(s)</h3>

<p>HwB  email: &lt;hwborchers@googlemail.com&gt;
</p>


<h3>References</h3>

<p>Madsen, K., and H. B. Nielsen (2010). Introduction to Optimization and
Data Fitting. Technical University of Denmark, Intitute of Computer
Science and Mathematical Modelling.
</p>
<p>Nielsen, H. B. (2000). Separable Nonlinear Least Squares. IMM, DTU,
Report IMM-REP-2000-01.
</p>


<h3>See Also</h3>

<p><code><a href="lsqnonlin.html">lsqsep</a></code>, <code><a href="lsqnonlin.html">lsqnonlin</a></code>
</p>


<h3>Examples</h3>

<pre>
#   Lanczos1 data (artificial data)
#   f(x) = 0.0951*exp(-x) + 0.8607*exp(-3*x) + 1.5576*exp(-5*x)
x &lt;- linspace(0, 1.15, 24)
y &lt;- c(2.51340000, 2.04433337, 1.66840444, 1.36641802, 1.12323249, 0.92688972,
       0.76793386, 0.63887755, 0.53378353, 0.44793636, 0.37758479, 0.31973932,
       0.27201308, 0.23249655, 0.19965895, 0.17227041, 0.14934057, 0.13007002,
       0.11381193, 0.10004156, 0.08833209, 0.07833544, 0.06976694, 0.06239313)
p0 &lt;- c(-0.3, -5.5, -7.6)
mexpfit(x, y, p0, const = FALSE)
## $a0
## [1] 0
## $a
## [1] 0.09510431 0.86071171 1.55758398
## $b
## [1] -1.000022 -3.000028 -5.000009
## $ssq
## [1] 1.936163e-16
## $iter
## [1] 26
## $errmess
## [1] "Stopped by small gradient."
</pre>

<hr /><div style="text-align: center;">[Package <em>pracma</em> version 2.3.8 <a href="00Index.html">Index</a>]</div>
</body></html>
