<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Matrix Square and p-th Roots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for sqrtm,rootm {pracma}"><tr><td>sqrtm,rootm {pracma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Matrix Square and p-th Roots
</h2>

<h3>Description</h3>

<p>Computes the matrix square root and matrix p-th root of a nonsingular
real matrix.
</p>


<h3>Usage</h3>

<pre>
sqrtm(A, kmax = 20, tol = .Machine$double.eps^(1/2))
signm(A, kmax = 20, tol = .Machine$double.eps^(1/2))

rootm(A, p, kmax = 20, tol = .Machine$double.eps^(1/2))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>A</code></td>
<td>
<p>numeric, i.e. real, matrix.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>p-th root to be taken.</p>
</td></tr>
<tr valign="top"><td><code>kmax</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>absolut tolerance, norm distance of <code>A</code> and <code>B^p</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A real matrix may or may not have a real square root; if it has no real
negative eigenvalues. The number of square roots can vary from two to
infinity. A positive definite matric has one distinguished square root,
called the principal one, with the property that the eigenvalues lie in
the segment
<code>{z | -pi/p &lt; arg(z) &lt; pi/p}</code> (for the p-th root).
</p>
<p>The matrix square root <code>sqrtm(A)</code> is computed here through the
Denman-Beavers iteration (see the references) with quadratic rate of
convergence, a refinement of the common Newton iteration determining
roots of a quadratic equation.
</p>
<p>The matrix p-th root <code>rootm(A)</code> is computed as a complex integral
</p>
<p style="text-align: center;"><i> A^{1/p} = \frac{p \sin(&pi;/p)}{&pi;} A \int_0^{&infin;} (x^p I + A)^{-1} dx</i></p>

<p>applying the trapezoidal rule along the unit circle.
</p>
<p>One application is the computation of the matrix logarithm as
</p>
<p style="text-align: center;"><i>\log A = 2^k log A^{1/2^k}</i></p>

<p>such that the argument to the logarithm is close to the identity matrix
and the Pade approximation can be applied to <i>\log(I + X)</i>.
</p>
<p>The matrix sector function is defined as <code>sectm(A,m)=(A^m)^(-1/p)%*%A</code>;
for <code>p=2</code> this is the matrix sign function.
</p>
<p><code>S=signm(A)</code> is real if A is and has the following properties:<br />
<code>S^2=Id; S A = A S</code><br />
<code>singm([0 A; B 0])=[0 C; C^-1 0]</code> where <code>C=A(BA)^-1</code>
</p>
<p>These functions arise in control theory.
</p>


<h3>Value</h3>

<p><code>sqrtm(A)</code> returns a list with components
</p>
<table summary="R valueblock">
<tr valign="top"><td><code> B </code></td>
<td>
<p>square root matrix of <code>A</code>.</p>
</td></tr>
<tr valign="top"><td><code> Binv </code></td>
<td>
<p>inverse of the square root matrix.</p>
</td></tr>
<tr valign="top"><td><code> k </code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr valign="top"><td><code> acc </code></td>
<td>
<p>accuracy or absolute error.</p>
</td></tr>
</table>
<p><code>rootm(A)</code> returns a list with components
</p>
<table summary="R valueblock">
<tr valign="top"><td><code> B </code></td>
<td>
<p>square root matrix of <code>A</code>.</p>
</td></tr>
<tr valign="top"><td><code> k </code></td>
<td>
<p>number of iterations.</p>
</td></tr>
<tr valign="top"><td><code> acc </code></td>
<td>
<p>accuracy or absolute error.</p>
</td></tr>
</table>
<p>If <code>k</code> is negative the iteration has <em>not</em> converged.
</p>
<p><code>signm</code> just returns one matrix, even when there was no convergence.
</p>


<h3>Note</h3>

<p>The p-th root of a positive definite matrix can also be computed from
its eigenvalues as
</p>
<p><code>E &lt;- eigen(A)</code><br />
<code>V &lt;- E\$vectors; U &lt;- solve(V)</code><br />
<code>D &lt;- diag(E\$values)</code><br />
<code>B &lt;- V %*% D^(1/p) %*% U</code>
</p>
<p>or by applying the functions <code>expm</code>, <code>logm</code> in package &lsquo;expm&rsquo;:
</p>
<p><code>B &lt;- expm(1/p * logm(A))</code>
</p>
<p>As these approaches all calculate the principal branch, the results are
identical (but will numerically slightly differ).
</p>


<h3>References</h3>

<p>N. J. Higham (1997). Stable Iterations for the Matrix Square Root.
Numerical Algorithms, Vol. 15, pp. 227&ndash;242.
</p>
<p>D. A. Bini, N. J. Higham, and B. Meini (2005). Algorithms for the
matrix pth root. Numerical Algorithms, Vol. 39, pp. 349&ndash;378.
</p>


<h3>See Also</h3>

<p><code><a href="expm.html">expm</a></code>, <code>expm::sqrtm</code>
</p>


<h3>Examples</h3>

<pre>
A1 &lt;- matrix(c(10,  7,  8,  7,
                7,  5,  6,  5,
                8,  6, 10,  9,
                7,  5,  9, 10), nrow = 4, ncol = 4, byrow = TRUE)

X &lt;- sqrtm(A1)$B    # accuracy: 2.352583e-13
X 

A2 &lt;- matrix(c(90.81, 8.33, 0.68, 0.06, 0.08, 0.02, 0.01, 0.01,
                0.70, 90.65, 7.79, 0.64, 0.06, 0.13, 0.02, 0.01,
                0.09, 2.27, 91.05, 5.52, 0.74, 0.26, 0.01, 0.06,
                0.02, 0.33, 5.95, 85.93, 5.30, 1.17, 1.12, 0.18,
                0.03, 0.14, 0.67, 7.73, 80.53, 8.84, 1.00, 1.06,
                0.01, 0.11, 0.24, 0.43, 6.48, 83.46, 4.07, 5.20,
                0.21, 0, 0.22, 1.30, 2.38, 11.24, 64.86, 19.79,
                0, 0, 0, 0, 0, 0, 0, 100
              ) / 100, nrow = 8, ncol = 8, byrow = TRUE)

X &lt;- rootm(A2, 12)  # k = 6, accuracy: 2.208596e-14

##  Matrix sign function
signm(A1)                               # 4x4 identity matrix
B &lt;- rbind(cbind(zeros(4,4), A1),
           cbind(eye(4), zeros(4,4)))
signm(B)                                # [0, signm(A1)$B; signm(A1)$Binv 0]
</pre>

<hr /><div style="text-align: center;">[Package <em>pracma</em> version 2.3.8 <a href="00Index.html">Index</a>]</div>
</body></html>
