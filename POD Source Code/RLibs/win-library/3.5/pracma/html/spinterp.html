<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Monotone (Shape-Preserving) Interpolation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for spinterp {pracma}"><tr><td>spinterp {pracma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Monotone (Shape-Preserving) Interpolation
</h2>

<h3>Description</h3>

<p>Monotone interpolation preserves the monotonicity of the data being
interpolated, and when the data points are also monotonic, the slopes 
of the interpolant should also be monotonic.
</p>


<h3>Usage</h3>

<pre>
spinterp(x, y, xp)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x, y</code></td>
<td>
<p>x- and y-coordinates of the points that shall be interpolated.</p>
</td></tr>
<tr valign="top"><td><code>xp</code></td>
<td>
<p>points that should be interpolated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implementation follows a cubic version of the method of Delbourgo and
Gregory. It yields &lsquo;shaplier&rsquo; curves than the Stineman method.
</p>
<p>The calculation of the slopes is according to recommended practice:
</p>
<p>- monotonic and convex &ndash;&gt; harmonic<br />
- monotonic and nonconvex &ndash;&gt; geometric<br />
- nonmonotonic and convex &ndash;&gt; arithmetic<br />
- nonmonotonic and nonconvex &ndash;&gt; circles (Stineman) [not implemented]
</p>
<p>The choice of supplementary coefficients <code>r[i]</code> depends on whether
the data are montonic or convex or both:
</p>
<p>- monotonic, but not convex<br />
- otherwise
</p>
<p>and that can be detected from the data. The choice <code>r[i]=3</code> for all
<code>i</code> results in the standard cubic Hermitean rational interpolation.
</p>


<h3>Value</h3>

<p>The interpolated values at all the points of <code>xp</code>.
</p>


<h3>Note</h3>

<p>At the moment, the data need to be monotonic and the case of convexity
is not considered.
</p>


<h3>References</h3>

<p>Stan Wagon (2010). Mathematica in Action. Third Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code>stinepack::stinterp</code>, <code>demography::cm.interp</code>
</p>


<h3>Examples</h3>

<pre>
data1 &lt;- list(x = c(1,2,3,5,6,8,9,11,12,14,15),
              y = c(rep(10,6), 10.5,15,50,60,95))
data2 &lt;- list(x = c(0,1,4,6.5,9,10),
              y = c(10,4,2,1,3,10))
data3 &lt;- list(x = c(7.99,8.09,8.19,8.7,9.2,10,12,15,20),
              y = c(0,0.000027629,0.00437498,0.169183,0.469428,
                    0.94374,0.998636,0.999919,0.999994))
data4 &lt;- list(x = c(22,22.5,22.6,22.7,22.8,22.9,
                    23,23.1,23.2,23.3,23.4,23.5,24),
              y = c(523,543,550,557,565,575,
                    590,620,860,915,944,958,986))
data5 &lt;- list(x = c(0,1.1,1.31,2.5,3.9,4.4,5.5,6,8,10.1),
              y = c(10.1,8,4.7,4.0,3.48,3.3,5.8,7,7.7,8.6))

data6 &lt;- list(x = c(-0.8, -0.75, -0.3, 0.2, 0.5),
              y = c(-0.9,  0.3,   0.4, 0.5, 0.6))
data7 &lt;- list(x = c(-1, -0.96, -0.88, -0.62, 0.13, 1),
              y = c(-1, -0.4,   0.3,   0.78, 0.91, 1))

data8 &lt;- list(x = c(-1, -2/3, -1/3, 0.0, 1/3, 2/3, 1),
              y = c(-1, -(2/3)^3, -(1/3)^3, -(1/3)^3, (1/3)^3, (1/3)^3, 1))

## Not run: 
opr &lt;- par(mfrow=c(2,2))

# These are well-known test cases:
D &lt;- data1
plot(D, ylim=c(0, 100)); grid()
xp &lt;- seq(1, 15, len=51); yp &lt;- spinterp(D$x, D$y, xp)
lines(spline(D), col="blue")
lines(xp, yp, col="red")

D &lt;- data3
plot(D, ylim=c(0, 1.2)); grid()
xp &lt;- seq(8, 20, len=51); yp &lt;- spinterp(D$x, D$y, xp)
lines(spline(D), col="blue")
lines(xp, yp, col="red")

D &lt;- data4
plot(D); grid()
xp &lt;- seq(22, 24, len=51); yp &lt;- spinterp(D$x, D$y, xp)
lines(spline(D), col="blue")
lines(xp, yp, col="red")

# Fix a horizontal slope at the end points
D &lt;- data8
x &lt;- c(-1.05, D$x, 1.05); y &lt;- c(-1, D$y, 1)
plot(D); grid()
xp &lt;- seq(-1, 1, len=101); yp &lt;- spinterp(x, y, xp)
lines(spline(D, n=101), col="blue")
lines(xp, yp, col="red")

par(opr)
## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>pracma</em> version 2.3.8 <a href="00Index.html">Index</a>]</div>
</body></html>
