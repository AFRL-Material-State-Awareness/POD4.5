<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Construction of Multiple Contrast Profiles</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mcprofile {mcprofile}"><tr><td>mcprofile {mcprofile}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Construction of Multiple Contrast Profiles</h2>

<h3>Description</h3>

<p>Calculates signed root deviance profiles given a <code><a href="../../stats/html/glm.html">glm</a></code> or <code><a href="../../stats/html/lm.html">lm</a></code> object. The profiled parameters of interest are defined by providing a contrast matrix.
</p>


<h3>Usage</h3>

<pre>
mcprofile(object, CM, control = mcprofileControl(), grid = NULL)

## S3 method for class 'glm'
mcprofile(object, CM, control = mcprofileControl(),
  grid = NULL)

## S3 method for class 'lm'
mcprofile(object, CM, control = mcprofileControl(),
  grid = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>An object of class <code><a href="../../stats/html/glm.html">glm</a></code> or <code><a href="../../stats/html/lm.html">lm</a></code></p>
</td></tr>
<tr valign="top"><td><code>CM</code></td>
<td>
<p>A contrast matrix for the definition of parameter linear combinations (<code>CM %*% coefficients(object)</code>). The number of columns should be equal to the number of estimated parameters. Providing row names is recommendable.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>A list with control arguments. See <code><a href="mcprofileControl.html">mcprofileControl</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>grid</code></td>
<td>
<p>A matrix or list with profile support coordinates. Each column of the matrix or slot in a list corresponds to a row in the contrast matrix, each row of the grid matrix or element of a numeric vector in each list slot corresponds to a candidate of the contrast parameter. If NULL (default), a grid is found automatically similar to function <code><a href="../../MASS/html/profile.glm.html">profile.glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The profiles are calculates separately for each row of the contrast matrix. The profiles are calculated by constrained IRWLS optimization, implemented in function <code>orglm</code>, using the quadratic programming algorithm of package <code>quadprog</code>.
</p>


<h3>Value</h3>

<p>An object of class mcprofile. The slot <code>srdp</code> contains the profiled signed root deviance statistics. The <code>optpar</code> slot contains a matrix with profiled parameter estimates.
</p>


<h3>See Also</h3>

<p><code><a href="../../MASS/html/profile.glm.html">profile.glm</a></code>, <code><a href="../../multcomp/html/glht.html">glht</a></code>, <code><a href="../../multcomp/html/contrMat.html">contrMat</a></code>, <code><a href="confint.mcprofile.html">confint.mcprofile</a></code>, <code><a href="summary.mcprofile.html">summary.mcprofile</a></code>, <code><a href="../../quadprog/html/solve.QP.html">solve.QP</a></code>
</p>


<h3>Examples</h3>

<pre>
#######################################
## cell transformation assay example ##
#######################################

str(cta)
## change class of cta$conc into factor
cta$concf &lt;- factor(cta$conc, levels=unique(cta$conc))

ggplot(cta, aes(y=foci, x=concf)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 0.2) +  
  xlab("concentration")
    
    
# glm fit assuming a Poisson distribution for foci counts
# parameter estimation on the log link
# removing the intercept
fm &lt;- glm(foci ~ concf-1, data=cta, family=poisson(link="log"))

### Comparing each dose to the control by Dunnett-type comparisons
# Constructing contrast matrix
library(multcomp)
CM &lt;- contrMat(table(cta$concf), type="Dunnett")

# calculating signed root deviance profiles
(dmcp &lt;- mcprofile(fm, CM))
# plot profiles
plot(dmcp)
# confidence intervals
(ci &lt;- confint(dmcp))
plot(ci)
</pre>

<hr /><div style="text-align: center;">[Package <em>mcprofile</em> version 1.0-0 <a href="00Index.html">Index</a>]</div>
</body></html>
