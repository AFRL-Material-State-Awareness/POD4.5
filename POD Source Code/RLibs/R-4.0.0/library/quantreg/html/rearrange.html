<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Rearrangement</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for rearrange {quantreg}"><tr><td>rearrange {quantreg}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Rearrangement</h2>

<h3>Description</h3>

<p> Monotonize a step function by rearrangement </p>


<h3>Usage</h3>

<pre> rearrange(f,xmin,xmax) </pre>


<h3>Arguments</h3>

 
<table summary="R argblock">
<tr valign="top"><td><code>f</code></td>
<td>
<p> object of class stepfun </p>
</td></tr> 
<tr valign="top"><td><code>xmin</code></td>
<td>
<p>minimum of the support of the rearranged f</p>
</td></tr> 
<tr valign="top"><td><code>xmax</code></td>
<td>
<p>maximum of the support of the rearranged f</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Given a stepfunction <i>Q(u)</i>, not necessarily monotone, let 
<i>F(y) = \int \{ Q(u) &le; y \} du</i> denote the associated cdf
obtained by randomly evaluating <i>Q</i> at <i>U \sim U[0,1]</i>.  The
rearranged version of <i>Q</i> is <i>\tilde Q (u) = \inf \{
   u: F(y) &ge; u \}.  The rearranged function inherits the right
   or left continuity of original stepfunction.</i>
</p>


<h3>Value</h3>

<p> Produces transformed stepfunction that is monotonic increasing.  </p>


<h3>Author(s)</h3>

<p>R. Koenker</p>


<h3>References</h3>

 
<p>Chernozhukov, V., I. Fernandez-Val, and A. Galichon, (2006)  Quantile and Probability
Curves without Crossing, Econometrica, forthcoming.
</p>
<p>Chernozhukov, V., I. Fernandez-Val, and A. Galichon, (2009)  Improving Estimates of
Monotone Functions by Rearrangement, Biometrika, 96, 559&ndash;575. 
</p>
<p>Hardy, G.H., J.E. Littlewood, and G. Polya (1934)  Inequalities,  Cambridge U. Press.
</p>


<h3>See Also</h3>

 <p><code><a href="rq.html">rq</a></code> <code><a href="rearrange.html">rearrange</a></code></p>


<h3>Examples</h3>

<pre>
data(engel)
z &lt;- rq(foodexp ~ income, tau = -1,data =engel)
zp &lt;- predict(z,newdata=list(income=quantile(engel$income,.03)),stepfun = TRUE)
plot(zp,do.points = FALSE, xlab = expression(tau),
        ylab = expression(Q ( tau )), main="Engel Food Expenditure Quantiles")
plot(rearrange(zp),do.points = FALSE, add=TRUE,col.h="red",col.v="red")
legend(.6,300,c("Before Rearrangement","After Rearrangement"),lty=1,col=c("black","red"))
</pre>

<hr /><div style="text-align: center;">[Package <em>quantreg</em> version 5.94 <a href="00Index.html">Index</a>]</div>
</body></html>
