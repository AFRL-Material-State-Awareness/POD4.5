<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Numerically Evaluate Double and Triple Integrals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for integral2 {pracma}"><tr><td>integral2 {pracma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Numerically Evaluate Double  and Triple Integrals
</h2>

<h3>Description</h3>

<p>Numerically evaluate a double integral, resp. a triple integral by
reducing it to a double integral.
</p>


<h3>Usage</h3>

<pre>
integral2(fun, xmin, xmax, ymin, ymax, sector = FALSE,
            reltol = 1e-6, abstol = 0, maxlist = 5000,
            singular = FALSE, vectorized = TRUE, ...)

integral3(fun, xmin, xmax, ymin, ymax, zmin, zmax,
            reltol = 1e-6, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>fun</code></td>
<td>
<p>function</p>
</td></tr>
<tr valign="top"><td><code>xmin, xmax</code></td>
<td>
<p>lower and upper limits of x.</p>
</td></tr>
<tr valign="top"><td><code>ymin, ymax</code></td>
<td>
<p>lower and upper limits of y.</p>
</td></tr>
<tr valign="top"><td><code>zmin, zmax</code></td>
<td>
<p>lower and upper limits of z.</p>
</td></tr>
<tr valign="top"><td><code>sector</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr valign="top"><td><code>reltol</code></td>
<td>
<p>relative tolerance.</p>
</td></tr>
<tr valign="top"><td><code>abstol</code></td>
<td>
<p>absolute tolerance.</p>
</td></tr>
<tr valign="top"><td><code>maxlist</code></td>
<td>
<p>maximum length of the list of rectangles.</p>
</td></tr>
<tr valign="top"><td><code>singular</code></td>
<td>
<p>logical; are there singularities at vertices.</p>
</td></tr>
<tr valign="top"><td><code>vectorized</code></td>
<td>
<p>logical; is the function fully vectorized.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional parameters to be passed to the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>integral2</code> implements the &lsquo;TwoD&rsquo; algorithm, that is Gauss-Kronrod
with (3, 7)-nodes on 2D rectangles.
</p>
<p>The borders of the domain of integration must be finite. The limits of
<code>y</code>, that is <code>ymin</code> and <code>ymax</code>, can be constants or scalar
functions of x that describe the lower and upper boundaries. These
functions must be vectorized.
</p>
<p><code>integral2</code> attempts to satisfy <code>ERRBND &lt;= max(AbsTol,RelTol*|Q|)</code>.
This is absolute error control when <code>|Q|</code> is sufficiently small and
relative error control when <code>|Q|</code> is larger.
</p>
<p>The function <code>fun</code> itself must be fully vectorized:
It must accept arrays <code>X</code> and <code>Y</code> and return an array
<code>Z = f(X,Y)</code> of corresponding values. If option <code>vectorized</code> is
set to <code>FALSE</code> the procedure will enforce this vectorized behavior.
</p>
<p>With <code>sector=TRUE</code> the region is a generalized sector that is described
in polar coordinates (r,theta) by
</p>
<p><code>0 &lt;= a &lt;= theta &lt;= b</code> &ndash; a and b must be constants<br />
<code>c &lt;= r &lt;= d</code> &ndash; c and d can be constants or ...
</p>
<p>... functions of theta that describe the lower and upper boundaries.
Functions must be vectorized.<br />
NOTE Polar coordinates  are used only to describe the region &ndash;
the integrand is <code>f(x,y)</code> for both kinds of regions.
</p>
<p><code>integral2</code> can be applied to functions that are singular on a boundary.
With value <code>singular=TRUE</code>, this option causes <code>integral2</code> to use
transformations to weaken singularities for better performance.
</p>
<p><code>integral3</code> also accepts functions for the inner interval limits.
<code>ymin, ymax</code> must be constants or functions of one variable (<code>x</code>),
<code>zmin, zmax</code> constants or functions of two variables (<code>x, y</code>), all
functions vectorized.
</p>
<p>The triple integral will be first integrated over the second and third 
variable with <code>integral2</code>, and then integrated over a single variable 
with <code>integral</code>.
</p>


<h3>Value</h3>

<p>Returns a list with <code>Q</code> the integral and <code>error</code> the error term.
</p>


<h3>Note</h3>

<p>To avoid recursion, a possibly large matrix will be used and passed between
subprograms. A more efficient implementation may be possible.
</p>


<h3>Author(s)</h3>

<p>Copyright (c) 2008 Lawrence F. Shampine for Matlab code and description
of the program; adapted and converted to R by Hans W Borchers.
</p>


<h3>References</h3>

<p>Shampine, L. F. (2008). MATLAB Program for Quadrature in 2D.
Proceedings of Applied Mathematics and Computation, 2008, pp. 266&ndash;274.
</p>


<h3>See Also</h3>

<p><code><a href="integral.html">integral</a></code>, <code>cubature:adaptIntegrate</code>
</p>


<h3>Examples</h3>

<pre>
fun &lt;- function(x, y) cos(x) * cos(y)
integral2(fun, 0, 1, 0, 1, reltol = 1e-10)
# $Q:     0.708073418273571  # 0.70807341827357119350 = sin(1)^2
# $error: 8.618277e-19       # 1.110223e-16

##  Compute the volume of a sphere
f &lt;- function(x, y) sqrt(1 -x^2 - y^2)
xmin &lt;- 0; xmax &lt;- 1
ymin &lt;- 0; ymax &lt;- function(x) sqrt(1 - x^2)
I &lt;- integral2(f, xmin, xmax, ymin, ymax)
I$Q                             # 0.5236076 - pi/6 =&gt; 8.800354e-06

##  Compute the volume over a sector
I &lt;- integral2(f, 0,pi/2, 0,1, sector = TRUE)
I$Q                             # 0.5236308 - pi/6 =&gt; 3.203768e-05

##  Integrate 1/( sqrt(x + y)*(1 + x + y)^2 ) over the triangle
##   0 &lt;= x &lt;= 1, 0 &lt;= y &lt;= 1 - x.  The integrand is infinite at (0,0).
f &lt;- function(x,y) 1/( sqrt(x + y) * (1 + x + y)^2 )
ymax &lt;- function(x) 1 - x
I &lt;- integral2(f, 0,1, 0,ymax)
I$Q + 1/2 - pi/4                # -3.247091e-08

##  Compute this integral as a sector
rmax &lt;- function(theta) 1/(sin(theta) + cos(theta))
I &lt;- integral2(f, 0,pi/2, 0,rmax, sector = TRUE, singular = TRUE)
I$Q + 1/2 - pi/4                # -4.998646e-11

##  Examples of computing triple integrals
f0 &lt;- function(x, y, z) y*sin(x) + z*cos(x)
integral3(f0, 0, pi, 0,1, -1,1) # - 2.0 =&gt; 0.0

f1 &lt;- function(x, y, z) exp(x+y+z)
integral3(f1, 0, 1, 1, 2, 0, 0.5)
## [1] 5.206447                         # 5.20644655

f2 &lt;- function(x, y, z) x^2 + y^2 + z
a &lt;- 2; b &lt;- 4
ymin &lt;- function(x) x - 1
ymax &lt;- function(x) x + 6
zmin &lt;- -2
zmax &lt;- function(x, y) 4 + y^2
integral3(f2, a, b, ymin, ymax, zmin, zmax)
## [1] 47416.75556                      # 47416.7555556

f3 &lt;- function(x, y, z) sqrt(x^2 + y^2)
a &lt;- -2; b &lt;- 2
ymin &lt;- function(x) -sqrt(4-x^2)
ymax &lt;- function(x)  sqrt(4-x^2)
zmin &lt;- function(x, y)  sqrt(x^2 + y^2)
zmax &lt;- 2
integral3(f3, a, b, ymin, ymax, zmin, zmax)
## [1] 8.37758                          # 8.377579076269617
</pre>

<hr /><div style="text-align: center;">[Package <em>pracma</em> version 2.3.8 <a href="00Index.html">Index</a>]</div>
</body></html>
