<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Linear Least-Squares Fitting</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for lsqlin {pracma}"><tr><td>lsqlin {pracma}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Linear Least-Squares Fitting
</h2>

<h3>Description</h3>

<p>Solves linearly constrained linear least-squares problems.
</p>


<h3>Usage</h3>

<pre>
  lsqlin(A, b, C, d, tol = 1e-13)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>A</code></td>
<td>
<p><code>nxm</code>-matrix defining the least-squares problem.</p>
</td></tr>
<tr valign="top"><td><code>b</code></td>
<td>
<p>vector or colum matrix with <code>n</code> rows; when it has more than 
one column it describes several least-squares problems.</p>
</td></tr>
<tr valign="top"><td><code>C</code></td>
<td>
<p><code>pxm</code>-matrix for the constraint system.</p>
</td></tr>
<tr valign="top"><td><code>d</code></td>
<td>
<p>vector or <code>px1</code>-matrix, right hand side for the constraints.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>tolerance to be passed to <code>pinv</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lsqlin(A, b, C, d)</code> minimizes <code>||A*x - b||</code> (i.e., in the 
least-squares sense) subject to <code>C*x = d</code>.
</p>


<h3>Value</h3>

<p>Returns a least-squares solution as column vector, or a matrix of solutions 
in the columns if <code>b</code> is a matrix with several columns.
</p>


<h3>Note</h3>

<p>The Matlab function <code>lsqlin</code> solves a more general problem, allowing
additional linear inequalities and bound constraints. In <code>pracma</code> this
task is solved applying function <code>lsqlincon</code>.
</p>


<h3>Author(s)</h3>

<p>HwB  email: &lt;hwborchers@googlemail.com&gt;
</p>


<h3>References</h3>

<p>Trefethen, L. N., and D. Bau III. (1997). Numerical Linear Algebra.
SIAM, Society for Industrial and Applied Mathematics, Philadelphia.
</p>


<h3>See Also</h3>

<p><code><a href="nullspace.html">nullspace</a></code>, <code><a href="pinv.html">pinv</a></code>, <code><a href="lsqlincon.html">lsqlincon</a></code>
</p>


<h3>Examples</h3>

<pre>
A &lt;- matrix(c(
    0.8147,    0.1576,    0.6557,
    0.9058,    0.9706,    0.0357,
    0.1270,    0.9572,    0.8491,
    0.9134,    0.4854,    0.9340,
    0.6324,    0.8003,    0.6787,
    0.0975,    0.1419,    0.7577,
    0.2785,    0.4218,    0.7431,
    0.5469,    0.9157,    0.3922,
    0.9575,    0.7922,    0.6555,
    0.9649,    0.9595,    0.1712), 10, 3, byrow = TRUE)
b &lt;- matrix(c(
    0.7060,    0.4387,
    0.0318,    0.3816,
    0.2769,    0.7655,
    0.0462,    0.7952,
    0.0971,    0.1869,
    0.8235,    0.4898,
    0.6948,    0.4456,
    0.3171,    0.6463,
    0.9502,    0.7094,
    0.0344,    0.7547), 10, 2, byrow = TRUE)
C &lt;- matrix(c(
    1.0000,    1.0000,    1.0000,
    1.0000,   -1.0000,    0.5000), 2, 3, byrow = TRUE)
d &lt;- as.matrix(c(1, 0.5))

# With a full rank constraint system
(L &lt;- lsqlin(A, b, C, d))
#  0.10326838 0.3740381
#  0.03442279 0.1246794
#  0.86230882 0.5012825
C %*% L
#  1.0  1.0
#  0.5  0.5

## Not run: 
# With a rank deficient constraint system
C &lt;- str2num('[1 1 1;1 1 1]')
d &lt;- str2num('[1;1]')
(L &lt;- lsqlin(A, b[, 1], C, d))
#  0.2583340
# -0.1464215
#  0.8880875
C %*% L         # 1 1  as column vector

# Where both A and C are rank deficient
A2 &lt;- repmat(A[, 1:2], 1, 2)
C &lt;- ones(2, 4) # d as above
(L &lt;- lsqlin(A2, b[, 2], C, d))
#  0.2244121
#  0.2755879
#  0.2244121
#  0.2755879
C %*% L         # 1 1  as column vector
## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>pracma</em> version 2.3.8 <a href="00Index.html">Index</a>]</div>
</body></html>
