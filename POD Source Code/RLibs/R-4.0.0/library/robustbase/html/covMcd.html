<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Robust Location and Scatter Estimation via MCD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for covMcd {robustbase}"><tr><td>covMcd {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Robust Location and Scatter Estimation via MCD</h2>

<h3>Description</h3>

<p>Compute the Minimum Covariance Determinant (MCD) estimator,
a robust multivariate location and scale estimate with a high
breakdown point, via the &lsquo;Fast MCD&rsquo; or &lsquo;Deterministic
MCD&rsquo; (&ldquo;DetMcd&rdquo;) algorithm.
</p>


<h3>Usage</h3>

<pre>
covMcd(x, cor = FALSE, raw.only = FALSE,
       alpha =, nsamp =, nmini =, kmini =,
       scalefn =, maxcsteps =,
       initHsets = NULL, save.hsets = FALSE, names = TRUE, 
       seed =, tolSolve =, trace =,
       use.correction =, wgtFUN =, control = rrcov.control())
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a matrix or data frame.</p>
</td></tr>
<tr valign="top"><td><code>cor</code></td>
<td>
<p>should the returned result include a correlation matrix?
Default is <code>cor = FALSE</code>.</p>
</td></tr>
<tr valign="top"><td><code>raw.only</code></td>
<td>
<p>should only the &ldquo;raw&rdquo; estimate be returned,
i.e., no (re)weighting step be performed; default is false.</p>
</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
<p>numeric parameter controlling the size of the subsets
over which the determinant is minimized; roughly <code>alpha*n</code>,
(see &lsquo;Details&rsquo; below)
observations are used for computing the determinant.  Allowed values
are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
<tr valign="top"><td><code>nsamp</code></td>
<td>
<p>number of subsets used for initial estimates or <code>"best"</code>,
<code>"exact"</code>, or <code>"deterministic"</code>.  Default is <code>nsamp = 500</code>.
For <code>nsamp = "best"</code> exhaustive enumeration is done, as long as
the number of trials does not exceed 100'000 (<code>= nLarge</code>).
For <code>"exact"</code>, exhaustive enumeration will be attempted however
many samples are needed.  In this case a warning message may be
displayed saying that the computation can take a very long time.
</p>
<p>For <code>"deterministic"</code>, the <em>deterministic</em> MCD is computed; as
proposed by Hubert et al. (2012) it starts from the <i>h</i> most
central observations of <em>six</em> (deterministic) estimators.
</p>
</td></tr>
<tr valign="top"><td><code>nmini, kmini</code></td>
<td>
<p>for <i>n &gt;= 2 n_0</i>,
<i>n_0 := \code{nmini}</i>, the algorithm splits the data into
maximally <code>kmini</code> (by default 5) subsets, of size
approximately, but at least <code>nmini</code>.  When <code>nmini*kmini &lt; n</code>,
the initial search uses only a <em>subsample</em> of size <code>nmini*kmini</code>.

The original algorithm had <code>nmini = 300</code> and <code>kmini = 5</code>
hard coded.</p>
</td></tr>
<tr valign="top"><td><code>scalefn</code></td>
<td>
<p>for the deterministic MCD: <code><a href="../../base/html/function.html">function</a></code> to
compute a robust scale estimate or character string specifying a
rule determining such a function.  The default, currently
<code>"hrv2012"</code>, uses the recommendation of Hubert, Rousseeuw and
Verdonck (2012) who recommend <code><a href="Qn.html">Qn</a></code>
for <i>n &lt; 1000</i> and <code><a href="scaleTau2.html">scaleTau2</a></code> for larger n.  Alternatively,
<code>scalefn = "v2014"</code>, uses that rule with cutoff <i>n = 5000</i>.</p>
</td></tr>
<tr valign="top"><td><code>maxcsteps</code></td>
<td>
<p>maximal number of concentration steps in the
deterministic MCD; should not be reached.</p>
</td></tr>
<tr valign="top"><td><code>initHsets</code></td>
<td>
<p>NULL or a <i>K x h</i> integer matrix of initial
subsets of observations of size <i>h</i> (specified by the indices in
<code>1:n</code>).</p>
</td></tr>
<tr valign="top"><td><code>save.hsets</code></td>
<td>
<p>(for deterministic MCD) logical indicating if the
initial subsets should be returned as <code>initHsets</code>.</p>
</td></tr>
<tr valign="top"><td><code>names</code></td>
<td>
<p>logical; if true (as by default), several parts of the
result have a <code><a href="../../base/html/names.html">names</a></code> or <code><a href="../../base/html/dimnames.html">dimnames</a></code>
respectively, derived from data matrix <code>x</code>.</p>
</td></tr>
<tr valign="top"><td><code>seed</code></td>
<td>
<p>initial seed for random generator, like
<code><a href="../../base/html/Random.html">.Random.seed</a></code>, see <code><a href="rrcov.control.html">rrcov.control</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>tolSolve</code></td>
<td>
<p>numeric tolerance to be used for inversion
(<code><a href="../../Matrix/html/solve-methods.html">solve</a></code>) of the covariance matrix in <code><a href="../../stats/html/mahalanobis.html">mahalanobis</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>trace</code></td>
<td>
<p>logical (or integer) indicating if intermediate results
should be printed; defaults to <code>FALSE</code>; values <i>&gt;= 2</i>
also produce print from the internal (Fortran) code.</p>
</td></tr>
<tr valign="top"><td><code>use.correction</code></td>
<td>
<p> whether to use finite sample correction
factors; defaults to <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>wgtFUN</code></td>
<td>
<p>a character string or <code><a href="../../base/html/function.html">function</a></code>, specifying
how the weights for the reweighting step should be computed.  Up to
April 2013, the only option has been the original proposal in (1999),
now specified by <code>wgtFUN = "01.original"</code> (or via
<code>control</code>).  Since <span class="pkg">robustbase</span> version 0.92-3, Dec.2014,
other predefined string options are available, though experimental,
see the experimental <code>.wgtFUN.covMcd</code> object.</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>a list with estimation options - this includes those
above provided in the function specification, see
<code><a href="rrcov.control.html">rrcov.control</a></code> for the defaults.  If <code>control</code> is
supplied, the parameters from it will be used.  If parameters are
passed also in the invocation statement, they will override the
corresponding elements of the control object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The minimum covariance determinant estimator of location and scatter
implemented in <code>covMcd()</code> is similar to <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function
<code><a href="../../MASS/html/cov.mcd.html">cov.mcd</a>()</code> in <a href="https://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a>.  The MCD method looks for
the <i>h (&gt; n/2)</i> (<i>h = h(&alpha;,n,p) =</i>
<code><a href="h.alpha.n.html">h.alpha.n</a>(alpha,n,p)</code>) observations (out of <i>n</i>)
whose classical covariance matrix has the lowest possible determinant.
</p>
<p>The raw MCD estimate of location is then the average of these <i>h</i> points,
whereas the raw MCD estimate of scatter is their covariance matrix,
multiplied by a consistency factor (<code>.MCDcons(p, h/n)</code>) and (if
<code>use.correction</code> is true) a finite sample correction factor
(<code>.MCDcnp2(p, n, alpha)</code>), to make it consistent at the
normal model and unbiased at small samples.  Both rescaling factors
(consistency and finite sample) are returned in the length-2 vector
<code>raw.cnp2</code>.
</p>
<p>The implementation of <code>covMcd</code> uses the Fast MCD algorithm of
Rousseeuw and Van Driessen (1999) to approximate the minimum
covariance determinant estimator.
</p>
<p>Based on these raw MCD estimates, (unless argument <code>raw.only</code> is
true), a reweighting step is performed, i.e., <code>V &lt;- <a href="../../stats/html/cov.wt.html">cov.wt</a>(x,w)</code>,
where <code>w</code> are weights determined by &ldquo;outlyingness&rdquo; with
respect to the scaled raw MCD.  Again, a consistency factor and
(if <code>use.correction</code> is true) a finite sample correction factor
(<code>.MCDcnp2.rew(p, n, alpha)</code>) are applied.
The reweighted covariance is typically considerably more efficient
than the raw one, see Pison et al. (2002).
</p>
<p>The two rescaling factors for the reweighted estimates are returned in
<code>cnp2</code>.  Details for the computation of the finite sample
correction factors can be found in Pison et al. (2002).
</p>


<h3>Value</h3>

<p>An object of class <code>"mcd"</code> which is basically a
<code><a href="../../base/html/list.html">list</a></code> with components
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>center</code></td>
<td>
<p>the final estimate of location.</p>
</td></tr>
<tr valign="top"><td><code>cov</code></td>
<td>
<p>the final estimate of scatter.</p>
</td></tr>
<tr valign="top"><td><code>cor</code></td>
<td>
<p>the (final) estimate of the correlation matrix (only if
<code>cor = TRUE</code>).</p>
</td></tr>
<tr valign="top"><td><code>crit</code></td>
<td>
<p>the value of the criterion, i.e., the logarithm of the
determinant.  Previous to Nov.2014, it contained the determinant
itself which can under- or overflow relatively easily.</p>
</td></tr>
<tr valign="top"><td><code>best</code></td>
<td>
<p>the best subset found and used for computing the raw
estimates, with <code><a href="../../base/html/length.html">length</a>(best) == quan =
      <a href="h.alpha.n.html">h.alpha.n</a>(alpha,n,p)</code>.</p>
</td></tr>
<tr valign="top"><td><code>mah</code></td>
<td>
<p>mahalanobis distances of the observations using the final
estimate of the location and scatter.</p>
</td></tr>
<tr valign="top"><td><code>mcd.wt</code></td>
<td>
<p>weights of the observations using the final estimate of
the location and scatter.</p>
</td></tr>
<tr valign="top"><td><code>cnp2</code></td>
<td>
<p>a vector of length two containing the consistency
correction factor and the finite sample correction factor of
the final estimate of the covariance matrix.</p>
</td></tr>
<tr valign="top"><td><code>raw.center</code></td>
<td>
<p>the raw (not reweighted) estimate of location.</p>
</td></tr>
<tr valign="top"><td><code>raw.cov</code></td>
<td>
<p>the raw (not reweighted) estimate of scatter.</p>
</td></tr>
<tr valign="top"><td><code>raw.mah</code></td>
<td>
<p>mahalanobis distances of the observations based on the
raw estimate of the location and scatter.</p>
</td></tr>
<tr valign="top"><td><code>raw.weights</code></td>
<td>
<p>weights of the observations based on the raw
estimate of the location and scatter.</p>
</td></tr>
<tr valign="top"><td><code>raw.cnp2</code></td>
<td>
<p>a vector of length two containing the consistency
correction factor and the finite sample correction factor of
the raw estimate of the covariance matrix.</p>
</td></tr>
<tr valign="top"><td><code>X</code></td>
<td>
<p>the input data as numeric matrix, without <code><a href="../../base/html/NA.html">NA</a></code>s.</p>
</td></tr>
<tr valign="top"><td><code>n.obs</code></td>
<td>
<p>total number of observations.</p>
</td></tr>
<tr valign="top"><td><code>alpha</code></td>
<td>
<p>the size of the subsets over which the determinant is
minimized (the default is <i>(n+p+1)/2</i>).</p>
</td></tr>
<tr valign="top"><td><code>quan</code></td>
<td>
<p>the number of observations, <i>h</i>, on which the MCD is
based.  If <code>quan</code> equals <code>n.obs</code>, the MCD is the classical
covariance matrix.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>character string naming the method (Minimum Covariance
Determinant), starting with <code>"Deterministic"</code> when
<code>nsamp="deterministic"</code>.</p>
</td></tr>
<tr valign="top"><td><code>iBest</code></td>
<td>
<p>(for the deterministic MCD) contains indices from 1:6
denoting which of the (six) initial subsets lead to the best set found.</p>
</td></tr>
<tr valign="top"><td><code>n.csteps</code></td>
<td>
<p>(for the deterministic MCD) for each of the initial
subsets, the number of C-steps executed till convergence.</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
<p>the call used (see <code><a href="../../base/html/match.call.html">match.call</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Valentin Todorov <a href="mailto:valentin.todorov@chello.at">valentin.todorov@chello.at</a>, based on
work written for S-plus by Peter Rousseeuw and Katrien van Driessen
from University of Antwerp.
</p>
<p>Visibility of (formerly internal) tuning parameters, notably
<code>wgtFUN()</code>: Martin Maechler
</p>


<h3>References</h3>

<p>Rousseeuw, P. J. and Leroy, A. M. (1987)
<em>Robust Regression and Outlier Detection.</em> Wiley.
</p>
<p>Rousseeuw, P. J. and van Driessen, K. (1999)
A fast algorithm for the minimum covariance determinant estimator.
<em>Technometrics</em> <b>41</b>, 212&ndash;223.
</p>
<p>Pison, G., Van Aelst, S., and Willems, G. (2002)
Small Sample Corrections for LTS and MCD,
<em>Metrika</em> <b>55</b>, 111&ndash;123.
</p>
<p>Hubert, M., Rousseeuw, P. J. and Verdonck, T. (2012)
A deterministic algorithm for robust location and scatter.
Journal of Computational and Graphical Statistics <b>21</b>, 618&ndash;637.
</p>


<h3>See Also</h3>

<p><code><a href="../../MASS/html/cov.mcd.html">cov.mcd</a></code> from package <a href="https://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a>;
<code><a href="covOGK.html">covOGK</a></code> as cheaper alternative for larger dimensions.
</p>
<p><code><a href="../../robustX/html/BACON.html">BACON</a></code> and <code><a href="../../robustX/html/covNNC.html">covNNC</a></code>,
from package <a href="https://CRAN.R-project.org/package=robustX"><span class="pkg">robustX</span></a>;
</p>


<h3>Examples</h3>

<pre>
data(hbk)
hbk.x &lt;- data.matrix(hbk[, 1:3])
set.seed(17)
(cH &lt;- covMcd(hbk.x))
cH0 &lt;- covMcd(hbk.x, nsamp = "deterministic")
with(cH0, stopifnot(quan == 39,
     iBest == c(1:4,6), # 5 out of 6 gave the same
     identical(raw.weights, mcd.wt),
     identical(which(mcd.wt == 0), 1:14), all.equal(crit, -1.045500594135)))

## the following three statements are equivalent
c1 &lt;- covMcd(hbk.x, alpha = 0.75)
c2 &lt;- covMcd(hbk.x, control = rrcov.control(alpha = 0.75))
## direct specification overrides control one:
c3 &lt;- covMcd(hbk.x, alpha = 0.75,
             control = rrcov.control(alpha=0.95))
c1

## Martin's smooth reweighting:

## List of experimental pre-specified wgtFUN() creators:
## Cutoffs may depend on  (n, p, control$beta) :
str(.wgtFUN.covMcd)

cMM &lt;- covMcd(hbk.x, wgtFUN = "sm1.adaptive")

ina &lt;- which(names(cH) == "call")
all.equal(cMM[-ina], cH[-ina]) # *some* differences, not huge (same 'best'):
stopifnot(all.equal(cMM[-ina], cH[-ina], tol = 0.2))
</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.95-0 <a href="00Index.html">Index</a>]</div>
</body></html>
