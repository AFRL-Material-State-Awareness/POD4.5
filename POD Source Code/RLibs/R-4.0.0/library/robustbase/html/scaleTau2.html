<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Robust Tau-Estimate of Scale</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for scaleTau2 {robustbase}"><tr><td>scaleTau2 {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Robust Tau-Estimate of Scale</h2>

<h3>Description</h3>

<p>Computes the robust <i>&tau;</i>-estimate of univariate scale, as
proposed by Maronna and Zamar (2002); improved by a consistency factor,


</p>


<h3>Usage</h3>

<pre>
scaleTau2(x, c1 = 4.5, c2 = 3.0, na.rm = FALSE, consistency = TRUE,
          mu0 = median(x),
          sigma0 = median(x.), mu.too = FALSE, iter = 1, tol.iter = 1e-7)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr valign="top"><td><code>c1,c2</code></td>
<td>
<p>non-negative numbers, specifying cutoff values for the
biweighting of the mean and the rho function respectively.</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p>a logical value indicating whether <code>NA</code>
values should be stripped before the computation proceeds.</p>
</td></tr>
<tr valign="top"><td><code>consistency</code></td>
<td>
<p>logical indicating if the consistency correction
factor (for the scale) should be applied.</p>
</td></tr>
<tr valign="top"><td><code>mu0</code></td>
<td>
<p>the initial location estimate <i>mu0</i>, defaulting to
the <code><a href="../../stats/html/median.html">median</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>sigma0</code></td>
<td>
<p>the initial scale estimate <i>s0</i>, defaulting to
the MAD; may be set to a positive value when the MAD is zero.</p>
</td></tr>
<tr valign="top"><td><code>mu.too</code></td>
<td>
<p>logical indicating if both location and scale should be
returned or just the scale (when <code>mu.too=FALSE</code> as by default).</p>
</td></tr>
<tr valign="top"><td><code>iter</code></td>
<td>
<p>positive integer or logical indicating if and how many
iterations should be done.  The default, <code>iter = 1</code> computes the
&ldquo;traditional&rdquo; tau-estimate of scale.</p>
</td></tr>
<tr valign="top"><td><code>tol.iter</code></td>
<td>
<p>if <code>iter</code> is true, or <code>iter &gt; 1</code>, stop the
iterations when <i>|s_n - s_o| &le; &epsilon; s_n</i>, where
<i>&epsilon; :=</i><code>tol.iter</code>, and  <i>s_o</i> and <i>s_n</i> are the
previous and current estimates of <i>&sigma;</i>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, <i>s0</i> := MAD, i.e. the equivalent of <code><a href="../../stats/html/mad.html">mad</a>(x,
    constant=1)</code> is computed.  Robustness weights
<i>w_i := w_{c1}((x_i - med(X))/ s_0)</i> are computed, where
<i>w_c(u) = max(0, (1 - (u/c)^2)^2)</i>.  The robust location
measure is defined as <i>&mu;(X) := (&sum;_i w_i x_i)/(&sum;_i w_i)</i>,
and the robust <i>tau</i>-estimate is <i>s(X)^2 :=
    s_0^2 * (1/n) &sum;_i &rho;_{c2}((x_i - &mu;(X))/s_0)</i>,
where <i>&rho;_c(u) = min(c^2, u^2)</i>.
<br />
When <code>iter=TRUE</code> or <code>iter &gt; 1</code>, the above estimate is
<em>iterated</em> in a fixpoint iteration, setting <i>s_0</i> to the current
estimate <i>s(X)</i> and iterating until the number of iterations is
larger than <code>iter</code> or the fixpoint is found in the sense that
\
<br />
<code>scaleTau2(*, consistency=FALSE)</code> returns <i>s(X)</i>, whereas
this value is divided by its asymptotic limit when <code>consistency =
    TRUE</code> as by default.
</p>
<p>Note that for <code>n = length(x) == 2</code>, all equivariant scale estimates are
proportional, and specifically, <code>scaleTau2(x, consistency=FALSE)
    == mad(x, constant=1)</code>.  See also the reference.
</p>


<h3>Value</h3>

<p>numeric vector of length one (if <code>mu.too</code> is <code>FALSE</code> as by
default) or two (when <code>mu.too = TRUE</code>) with robust scale or
(location,scale) estimators
<i>s^(x)</i> or
<i>(m^(x), s^(x))</i>.
</p>


<h3>Author(s)</h3>

<p>Original by Kjell Konis with substantial modifications by
Martin Maechler.
</p>


<h3>References</h3>

<p>Maronna, R.A. and Zamar, R.H. (2002)
Robust estimates of location and dispersion of high-dimensional datasets;
<em>Technometrics</em> <b>44</b>(4), 307&ndash;317.

</p>
<p>Yohai, V.J., and Zamar, R.H. (1988).
High breakdown-point estimates of regression by means of the
minimization of an efficient scale.
<em>Journal of the American Statistical Association</em> <b>83</b>, 406&ndash;413.

</p>


<h3>See Also</h3>

<p><code><a href="Sn.html">Sn</a></code>, <code><a href="Qn.html">Qn</a></code>, <code><a href="../../stats/html/mad.html">mad</a></code>;
further <code><a href="covOGK.html">covOGK</a></code> for which <code>scaleTau2</code> was designed.
</p>


<h3>Examples</h3>

<pre>
x &lt;- c(1:7, 1000)
sd(x) # non-robust std.deviation
scaleTau2(x)
scaleTau2(x, mu.too = TRUE)
(sI  &lt;- scaleTau2(c(x,Inf), mu.too = TRUE))
(sIN &lt;- scaleTau2(c(x,Inf,NA), mu.too = TRUE, na.rm=TRUE))
stopifnot({
  identical(sI, sIN)
  all.equal(scaleTau2(c(x, 999), mu.too = TRUE), sIN,
            tol = 1e-15)
})

if(doExtras &lt;- robustbase:::doExtras()) {
 set.seed(11)
 ## show how much faster this is, compared to Qn
 x &lt;- sample(c(rnorm(1e6), rt(5e5, df=3)))
 (system.time(Qx &lt;- Qn(x)))         ## 2.04 [2017-09, lynne]
 (system.time(S2x &lt;- scaleTau2(x))) ## 0.25    (ditto)
 cbind(Qn = Qx, sTau2 = S2x)
}##       Qn    sTau2
##  1.072556 1.071258
</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.95-0 <a href="00Index.html">Index</a>]</div>
</body></html>
