<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Smooth Weighting Function - Generalized Biweight</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for smoothWgt {robustbase}"><tr><td>smoothWgt {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Smooth Weighting Function - Generalized Biweight</h2>

<h3>Description</h3>

<p>&ldquo;The Biweight on a Stick&rdquo; &mdash;
Compute a smooth (when <i>h &gt; 0</i>) weight function typically for
computing weights from large (robust) &ldquo;distances&rdquo; using a
piecewise polynomial function which in fact is a
2-parameter generalization of Tukey's 1-parameter &ldquo;biweight&rdquo;.
</p>


<h3>Usage</h3>

<pre>
smoothWgt(x, c, h)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>numeric vector of abscissa values</p>
</td></tr>
<tr valign="top"><td><code>c</code></td>
<td>
<p>&ldquo;cutoff&rdquo;, a typically positive number.</p>
</td></tr>
<tr valign="top"><td><code>h</code></td>
<td>
<p>&ldquo;bandwidth&rdquo;, a positive number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <i>w(x;c,h) := </i><code>smoothWgt(x, c, h)</code>.  Then,
</p>
<p style="text-align: center;"><i>
    w(x; c,h) := 0   if |x| &gt;= c + h/2,</i></p>

<p style="text-align: center;"><i>
    w(x; c,h) := 1   if |x| &lt;= c - h/2,</i></p>

<p style="text-align: center;"><i>
    w(x; c,h) := (1 - (|x| - (c-h/2))^2)^2   if c-h/2 &lt; |x| &lt; c+h/2.</i></p>

<p><code>smoothWgt()</code> is <em>scale invariant</em> in the sense that
</p>
<p style="text-align: center;"><i>
    w(S x; S c, S h) = w(x; c, h),</i></p>
<p> when <i>S &gt; 0</i>.
</p>


<h3>Value</h3>

<p>a numeric vector of the same length as <code>x</code> with weights between
zero and one.  Currently all <code><a href="../../base/html/attributes.html">attributes</a></code> including
<code><a href="../../base/html/dim.html">dim</a></code> and <code><a href="../../base/html/names.html">names</a></code> are dropped.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="M.psi.html">Mwgt</a>(.., psi = "bisquare")</code> of which <code>smoothWgt()</code>
is a generalization, and
<code><a href="M.psi.html">Mwgt</a>(.., psi = "optimal")</code> which looks similar for larger
<code>c</code> with its constant one part around zero, but also has only
one parameter.
</p>


<h3>Examples</h3>

<pre>
## a somewhat typical picture:
curve(smoothWgt(x, c=3, h=1), -5,7, n = 1000)

csW &lt;- curve(smoothWgt(x, c=1/2, h=1), -2,2) # cutoff 1/2, bandwidth 1
## Show that the above is the same as
## Tukey's "biweight" or "bi-square" weight function:
bw &lt;- function(x) pmax(0, (1 - x^2))^2
cbw &lt;- curve(bw,                     col=adjustcolor(2, 1/2), lwd=2, add=TRUE)
cMw &lt;- curve(Mwgt(x,c=1,"biweight"), col=adjustcolor(3, 1/2), lwd=2, add=TRUE)
stopifnot(## proving they are all the same:
   all.equal(csW, cbw, tol=1e-15),
   all.equal(csW, cMw, tol=1e-15))
</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.95-0 <a href="00Index.html">Index</a>]</div>
</body></html>
