<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Find Tuning Constant(s) for &quot;lqq&quot; and &quot;ggw&quot; Psi Functions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for psi.findc {robustbase}"><tr><td>psi.findc {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Find Tuning Constant(s) for &quot;lqq&quot; and &quot;ggw&quot; Psi Functions</h2>

<h3>Description</h3>

<p>Find psi function tuning constant sets for <code>"LQQ"</code> and <code>"GGW"</code>
psi (<i>&psi;</i>) functions by specifying largest descent (minimal
slope), efficiency and or breakdown point.
</p>
<p><code>.psi.const()</code> is called from <code><a href="lmrob.control.html">lmrob.control</a>()</code> to
set the tuning constants for psi and chi for <code>"LQQ"</code> and
<code>"GGW"</code> psi.  Unless  the specified tuning constants are from
fixed small set where the computations are stored precomputed,
<code>.psi.const()</code> calls the corresponding <code>.psi.&lt;psi&gt;.findc()</code>.
</p>


<h3>Usage</h3>

<pre>
.psi.ggw.findc(ms, b, eff = NA, bp = NA,
               subdivisions = 100L,
               rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
               tol = .Machine$double.eps^0.25, ms.tol = tol/64, maxiter = 1000)

.psi.lqq.findc(ms, b.c, eff = NA, bp = NA,
               interval = c(0.1, 4), subdivisions = 100L,
               rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
               tol = .Machine$double.eps^0.25, maxiter = 1000)
.psi.const(cc, psi)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>ms</code></td>
<td>
<p>number, the minimal slope, typically negative.</p>
</td></tr>
<tr valign="top"><td><code>b, b.c</code></td>
<td>
<p>number, specifying <i>b</i> or <i>b/c</i> for <code>"ggw"</code>
or <code>"lqq"</code> respectively.</p>
</td></tr>
<tr valign="top"><td><code>eff</code></td>
<td>
<p>a number (or <code><a href="../../base/html/NA.html">NA</a></code>), the desired
<em>efficiency</em>, in <i>[0,1]</i> of the estimator.  If <code>NA</code>,
<code>bp</code> must be specified as valid number.</p>
</td></tr>
<tr valign="top"><td><code>bp</code></td>
<td>
<p>a number (or <code><a href="../../base/html/NA.html">NA</a></code>), the desired
<em><b>b</b>reakdown <b>p</b>oint</em> of the estimator, in <i>[0,1]</i>.</p>
</td></tr>
<tr valign="top"><td><code>interval</code></td>
<td>
<p>for finding <i>c</i> via <code><a href="../../stats/html/uniroot.html">uniroot</a>()</code>.</p>
</td></tr>
<tr valign="top"><td><code>subdivisions</code></td>
<td>
<p>passed to <code><a href="../../stats/html/integrate.html">integrate</a>()</code>.</p>
</td></tr>
<tr valign="top"><td><code>rel.tol, abs.tol</code></td>
<td>
<p>relative and absolute tolerance for
<code><a href="../../stats/html/integrate.html">integrate</a>()</code>.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>relative tolerance for <code><a href="../../stats/html/uniroot.html">uniroot</a>()</code>.</p>
</td></tr>
<tr valign="top"><td><code>ms.tol</code></td>
<td>
<p>relative tolerance for the internal
<code>.psi.ggw.finda()</code>, eventually passed to <code><a href="../../stats/html/optimize.html">optimize</a></code>
inside (internal) <code>.psi.ggw.mxs()</code>.</p>
</td></tr>
<tr valign="top"><td><code>maxiter</code></td>
<td>
<p>maximal number of iterations for
<code><a href="../../stats/html/uniroot.html">uniroot</a>()</code>.</p>
</td></tr>
</table>

<table summary="R argblock">
<tr valign="top"><td><code>cc</code></td>
<td>
<p>(for <code>.psi.const()</code>:) numeric vector of length 4,
containing all constants <code>c(ms, b*, eff, bp)</code>, where
<code>b* = b</code>   for <code>"ggw"</code> and
<code>b* = b.c</code> for <code>"lqq"</code>, and one of <code>(eff, bp)</code>
is <code>NA</code>.</p>
</td></tr>
<tr valign="top"><td><code>psi</code></td>
<td>
<p>a string, either <code>"ggw"</code> or <code>"lqq"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For some important special cases, the result of <code>.psi.*.findc()</code>
are stored precomputed for efficiency reasons.  These cases are (the
defaults for <code>tuning.chi</code> and <code>tuning.psi</code> respectively in
<code><a href="lmrob.control.html">lmrob.control</a>()</code>s result,
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
    <code>tuning.chi</code>               </td><td style="text-align: left;"><code>tuning.psi</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>c(-0.5, 1.5, NA, 0.5)</code>    </td><td style="text-align: left;"><code>c(-0.5, 1.5, 0.95, NA)</code>
  </td>
</tr>

</table>

<p>and for <code>"ggw"</code> additionally, these four cases:
</p>

<table summary="Rd table">
<tr>
 <td style="text-align: left;">
    <code>tuning.chi</code>               </td><td style="text-align: left;"><code>tuning.psi</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
                                  </td><td style="text-align: left;"><code>c(-0.5, 1.5, 0.85, NA)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>c(-0.5, 1,   NA,  0.5)</code>   </td><td style="text-align: left;"><code>c(-0.5, 1,   0.95, NA)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
                                  </td><td style="text-align: left;"><code>c(-0.5, 1,   0.85, NA)</code>
  </td>
</tr>

</table>
 
<p>Note that for <code>"ggw"</code>, exactly these <i>2+4 = 6</i> cases also
allow fast <i>&rho;</i> and <i>&chi;</i> (aka
<i>rho~(.)</i>, see <code><a href="M.psi.html">Mchi</a></code>),
function evaluations.  For all other tuning constant settings, rho()
evaluations are based on numerical integration via <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>'s own
<code>Rdqags()</code> C function (part of R's official API).
</p>


<h3>Value</h3>

<p>a <code><a href="../../base/html/numeric.html">numeric</a></code> vector of constants, for <code>"lqq"</code> or
<code>"ggw"</code> psi functions, respectively:
</p>

<dl>
<dt><code>"lqq"</code>:</dt><dd><p><i>(b, c, s) = (b/c * c, c, s = 1 - min_slope)</i>,</p>
</dd>
<dt><code>"ggw"</code>:</dt><dd><p><i>
	(0, a, b, c,  rho(Inf))</i>.</p>
</dd>
</dl>

<p><code>.psi.const(cc, psi)</code> returns the argument <code>cc</code> with the
above constant vectors as attribute <code>"constants"</code>, in the case of
<code>psi = "lqq"</code> in all cases (since <span class="pkg">robustbase</span> version &gt;=
0.93), for <code>psi = "ggw"</code> only in the non-standard cases.
</p>


<h3>Author(s)</h3>

<p>Manuel Koller (original) and Martin Maechler (arguments, export, docs).
</p>


<h3>References</h3>

<p>See the vignette about  
&ldquo;<i>psi</i>-Functions Available in Robustbase&rdquo;.
</p>


<h3>See Also</h3>

<p><code><a href="M.psi.html">Mpsi</a>()</code> etc for the psi function definitions;
<code><a href="lmrob.control.html">.Mpsi.tuning.defaults</a></code>, etc, for tuning constants'
defaults for <code><a href="lmrob.html">lmrob</a>()</code>.
</p>


<h3>Examples</h3>

<pre>
(c.ge95 &lt;- .psi.ggw.findc(ms = -0.5, b = 1.5, eff = 0.95))
(c.ge90 &lt;- .psi.ggw.findc(ms = -0.5, b = 1.5, eff = 0.90))
(c.gb50 &lt;- .psi.ggw.findc(ms = -0.5, b = 1.5,  bp = 0.50))
stopifnot(all.equal(c.ge95, c(0, 1.386362,   1.5, 1.0628199,  4.7773893), tol = 1e-5),
          all.equal(c.ge90, c(0, 1.0282811,  1.5, 0.87086259, 3.2075233), tol = 1e-5),
          all.equal(c.gb50, c(0, 0.20367394, 1.5, 0.29591308, 0.37033962),tol = 1e-5))

(cl.e.95 &lt;- .psi.lqq.findc(ms = -0.5, b.c = 1.5, eff = .95))
(cl.b.50 &lt;- .psi.lqq.findc(ms = -0.5, b.c = 1.5,  bp = .50))
stopifnot(all.equal(cl.e.95, c(1.4734061,  0.98227073, 1.5), tol = 1e-5),
          all.equal(cl.b.50, c(0.40154568, 0.26769712, 1.5), tol = 1e-5))
</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.95-0 <a href="00Index.html">Index</a>]</div>
</body></html>
