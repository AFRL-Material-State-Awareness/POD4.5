<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Remove Columns (or Rows) From a Matrix to Make It Full Rank</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for fullRank {robustbase}"><tr><td>fullRank {robustbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Remove Columns (or Rows) From a Matrix to Make It Full Rank</h2>

<h3>Description</h3>

<p>From the QR decomposition with pivoting, (<code><a href="../../Matrix/html/qr-methods.html">qr</a>(x, tol)</code> if
<i>n &ge; p</i>), if
the matrix is not of full rank, the corresponding columns (<i>n &gt;= p</i>) or rows (<i>n &lt; p</i>) are omitted to form a full rank matrix.
</p>


<h3>Usage</h3>

<pre>
fullRank(x, tol = 1e-7, qrx = qr(x, tol=tol))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a numeric matrix of dimension <i>n * p</i>, or a
similar object for which <code><a href="../../Matrix/html/qr-methods.html">qr</a>()</code> works.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>tolerance for determining rank (deficiency).  Currently is
simply passed to <code><a href="../../Matrix/html/qr-methods.html">qr</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>qrx</code></td>
<td>
<p>optionally may be used to pass a <code><a href="../../Matrix/html/qr-methods.html">qr</a>(x, ..)</code>;
only used when <code>p &lt;= n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a version of the matrix <code>x</code>, with less columns or rows if
<code>x</code>'s rank was smaller than <code>min(n,p)</code>.
</p>
<p>If <code>x</code> is of full rank, it is returned unchanged.
</p>


<h3>Note</h3>

<p>This is useful for robustness algorithms that rely on <i>X</i> matrices
of full rank, e.g., <code><a href="adjOutlyingness.html">adjOutlyingness</a></code>.
</p>
<p>This also works for numeric data frames and whenever <code>qr()</code> works correctly.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="../../Matrix/html/qr-methods.html">qr</a></code>; for more sophisticated rank determination,
<code><a href="../../Matrix/html/rankMatrix.html">rankMatrix</a></code> from package <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a>.
</p>


<h3>Examples</h3>

<pre>
stopifnot(identical(fullRank(wood), wood))

## More sophisticated and delicate
dim(T &lt;- tcrossprod(data.matrix(toxicity))) # 38 x 38
dim(T. &lt;- fullRank(T)) # 38 x 10
if(requireNamespace("Matrix")) {
  rMmeths &lt;- eval(formals(Matrix::rankMatrix)$method)
  rT. &lt;- sapply(rMmeths, function(.m.) Matrix::rankMatrix(T., method = .m.))
  print(rT.) # "qr" (= "qrLinpack"): 13,  others rather 10
}
dim(T.2 &lt;- fullRank(T, tol = 1e-15))# 38 x 18
dim(T.3 &lt;- fullRank(T, tol = 1e-12))# 38 x 13
dim(T.3 &lt;- fullRank(T, tol = 1e-10))# 38 x 13
dim(T.3 &lt;- fullRank(T, tol = 1e-8 ))# 38 x 12
dim(T.) # default from above          38 x 10
dim(T.3 &lt;- fullRank(T, tol = 1e-5 ))# 38 x 10 -- still

plot(svd(T, 0,0)$d, log="y", main = "singular values of T", yaxt="n")
axis(2, at=10^(-14:5), las=1)
## pretty clearly indicates that  rank 10  is "correct" here.
</pre>

<hr /><div style="text-align: center;">[Package <em>robustbase</em> version 0.95-0 <a href="00Index.html">Index</a>]</div>
</body></html>
