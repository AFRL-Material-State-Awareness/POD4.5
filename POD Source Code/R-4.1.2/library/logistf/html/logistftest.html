<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Penalized Likelihood Ratio Test</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for logistftest {logistf}"><tr><td>logistftest {logistf}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Penalized Likelihood Ratio Test</h2>

<h3>Description</h3>

<p>This function performs a penalized likelihood ratio test on some (or
all) selected factors.  The resulting object is of the class logistftest
and includes the information printed by the proper print method.
</p>


<h3>Usage</h3>

<pre>
logistftest(object, test, values, firth = TRUE, beta0, weights, control)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a fitted logistf object
</p>
</td></tr>
<tr valign="top"><td><code>test</code></td>
<td>
<p>righthand formula of parameters to test (e.g. <code>~ B +
    D - 1</code>). As default all parameter apart from the intercept are tested.
If the formula includes -1, the intercept is omitted from testing.
As alternative to the formula one can give the indexes of the
ordered effects to test (a vector of integers). To test only the
intercept specify <code>test = ~ - .</code> or <code>test = 1</code>.
</p>
</td></tr>
<tr valign="top"><td><code>values</code></td>
<td>
<p>null hypothesis values, default values are 0. For
testing the specific hypothesis B1=1, B4=2, B5=0 we specify <code>test= </code> 
<code>~B1+B4+B5-1</code> and <code>values=c(1,</code> <code>2,0)</code>.</p>
</td></tr>
<tr valign="top"><td><code>firth</code></td>
<td>
<p>use of Firth's (1993) penalized maximum likelihood (<code>firth=TRUE</code>, default) or the
standard maximum likelihood method (<code>firth=FALSE</code>) for the logistic regression. Note
that by specifying <code>pl=TRUE</code> and <code>firth=FALSE</code> (and probably a lower number of iterations)
one obtains profile likelihood confidence intervals for maximum likelihood logistic
regression parameters.</p>
</td></tr>
<tr valign="top"><td><code>beta0</code></td>
<td>
<p>specifies the initial values of the coefficients for the fitting algorithm.</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>case weights</p>
</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
<p>control parameters for iterative fitting</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a penalized likelihood ratio test on some (or
all) selected factors.  The resulting object is of the class logistftest
and includes the information printed by the proper print method.  Further
documentation can be found in Heinze &amp; Ploner (2004).
</p>
<p>In most cases, the functionality of the logistftest function is replaced by <code>anova.logistf</code>, which is a more 
standard way to perform likelihood ratio tests. However, as shown in the example below, <code>logistftest</code> provides
some specials such as testing agains non-zero values. (By the way, <code>anova.logistf</code> calls  <code>logistftest</code>.)
</p>
<p>A <code>print</code> method is available.
</p>


<h3>Value</h3>

<p>The object returned is of the class logistf and has the following attributes:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>testcov</code></td>
<td>
<p>a vector of the fixed values of each covariate; NA stands for a parameter
which is not tested.</p>
</td></tr>
<tr valign="top"><td><code>loglik</code></td>
<td>
<p>a vector of the (penalized) log-likelihood of the full and the
restricted models. If the argument beta0 not missing, the full model isn't
evaluated.</p>
</td></tr>
<tr valign="top"><td><code>df</code></td>
<td>
<p>the number of degrees of freedom in the model.</p>
</td></tr>
<tr valign="top"><td><code>prob</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>
<p>the call object</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>depending on the fitting method &lsquo;Penalized ML&rsquo; or &lsquo;Standard ML&rsquo;.</p>
</td></tr>
<tr valign="top"><td><code>beta</code></td>
<td>
<p>the coefficients on the restricted solution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Georg Heinze</p>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em>
80, 27&ndash;38.
</p>
<p>Heinze G, Ploner M (2004). Technical Report 2/2004: A SAS-macro, S-PLUS library and
R package to perform logistic regression without convergence problems.
Section of Clinical Biometrics, Department of
Medical Computer Sciences, Medical University of Vienna, Vienna, Austria.
<a href="http://www.meduniwien.ac.at/user/georg.heinze/techreps/tr2_2004.pdf">http://www.meduniwien.ac.at/user/georg.heinze/techreps/tr2_2004.pdf</a>
</p>
<p>Heinze G (2006). A comparative investigation of methods for logistic regression
with separated or nearly separated data. <em>Statistics in Medicine</em> 25: 4216-4226.
</p>


<h3>See Also</h3>

<p><code><a href="../../logistf/help/anova.logistf.html">anova.logistf</a></code>
</p>


<h3>Examples</h3>

<pre>
data(sex2)
fit&lt;-logistf(case ~ age+oc+vic+vicl+vis+dia,  data=sex2)

logistftest(fit, test = ~ vic + vicl - 1, values = c(2, 0))
                        
</pre>

<hr /><div style="text-align: center;">[Package <em>logistf</em> version 1.22 <a href="00Index.html">Index</a>]</div>
</div></body></html>
