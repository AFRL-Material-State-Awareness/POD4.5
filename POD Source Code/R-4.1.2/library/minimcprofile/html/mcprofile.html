<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Construction of Multiple Contrast Profiles</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for mcprofile {minimcprofile}"><tr><td>mcprofile {minimcprofile}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Construction of Multiple Contrast Profiles</h2>

<h3>Description</h3>

<p>The profiles are calculates separately for each row of the contrast matrix. The profiles are calculated by constrained IRWLS optimization, implemented in function <code>orglm</code>, using the quadratic programming algorithm of package <code>quadprog</code>.
</p>


<h3>Usage</h3>

<pre>
mcprofile(object, CM, control = minimcprofileControl(), grid = NULL)
</pre>


<h3>See Also</h3>

<p>Other mcprofile: 
<code><a href="../../minimcprofile/help/minimcprofile.html">minimcprofile</a>()</code>
</p>


<h3>Examples</h3>

<pre>
#######################################
## cell transformation assay example ##
#######################################

str(cta)
## change class of cta$conc into factor
cta$concf &lt;- factor(cta$conc, levels=unique(cta$conc))

ggplot(cta, aes(y=foci, x=concf)) + 
  geom_boxplot() +
  geom_dotplot(binaxis = "y", stackdir = "center", binwidth = 0.2) +  
  xlab("concentration")
    
    
# glm fit assuming a Poisson distribution for foci counts
# parameter estimation on the log link
# removing the intercept
fm &lt;- glm(foci ~ concf-1, data=cta, family=poisson(link="log"))

### Comparing each dose to the control by Dunnett-type comparisons
# Constructing contrast matrix
library(multcomp)
CM &lt;- contrMat(table(cta$concf), type="Dunnett")

# calculating signed root deviance profiles
(dmcp &lt;- mcprofile(fm, CM))
# plot profiles
plot(dmcp)
# confidence intervals
(ci &lt;- confint(dmcp))
plot(ci)
</pre>

<hr /><div style="text-align: center;">[Package <em>minimcprofile</em> version 0.0.0.9000 <a href="00Index.html">Index</a>]</div>
</div></body></html>
